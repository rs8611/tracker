<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pregnancy Journey Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F4FF; /* Very Light Lilac */
            color: #3A2E4F; /* Dark Plum */
        }
        .calendar-grid {
            grid-template-columns: repeat(7, minmax(0, 1fr));
        }
        .day {
            transition: all 0.2s ease-in-out;
            position: relative;
        }
        .day.checked {
            background-color: #C8E6C9; /* Gentle Mint */
            color: #3A2E4F;
            border-radius: 0.5rem;
        }
        .day.today {
            border: 2px solid #FFAB91; /* Soft Coral */
            border-radius: 0.5rem;
        }
        .day.milestone {
            background-color: #F0F4C3; /* Light Lime */
        }
        .day.due-date {
            background-color: #FF8A65; /* Deep Coral */
            color: white;
        }
        .day-checkbox {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 16px;
            height: 16px;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            background-color: rgba(255, 255, 255, 0.7);
            border: 1px solid #D1C4E9;
            border-radius: 4px;
            z-index: 10;
        }
        .day-checkbox:checked {
            background-color: #81C784; /* Medium Mint */
            border-color: #66BB6A; /* Darker Mint */
        }
        .day-checkbox:checked::after {
            content: 'âœ”';
            display: block;
            text-align: center;
            color: white;
            font-size: 10px;
            line-height: 14px;
        }
        .progress-bar-bg {
            background-color: #E1BEE7; /* Light Lavender */
        }
        .progress-bar-fill {
            background-color: #9CCC65; /* Avocado Green */
            transition: width 0.5s ease-in-out;
        }
        .nav-button {
            background-color: #E6EE9C; /* Pale Yellow-Green */
            color: #3A2E4F;
            transition: background-color 0.2s;
        }
        .nav-button:hover {
            background-color: #DCE775; /* Lighter Yellow-Green */
        }
        .milestone-text {
            font-size: 0.75rem;
            margin-top: 0.25rem;
            font-weight: 700;
            font-style: italic;
            color: #BFA38F; /* Subtle light gold/tan */
        }
        .day span {
            z-index: 5;
            position: relative;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-[#3A2E4F]">Our Pregnancy Journey</h1>
            <p class="text-lg text-[#6A5A82] mt-2">From May 29, 2025 to March 5, 2026</p>
        </header>

        <main>
            <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-lg p-6 mb-8 border border-gray-100">
                <h2 class="text-2xl font-semibold mb-4 text-center">Progress Overview</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div>
                        <p class="text-sm text-gray-500">Current Week</p>
                        <p id="currentWeek" class="text-2xl font-bold">1</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Trimester</p>
                        <p id="currentTrimester" class="text-2xl font-bold">1</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Days Along</p>
                        <p id="daysAlong" class="text-2xl font-bold">0 / 280</p>
                    </div>
                </div>
                <div class="mt-6">
                    <div class="progress-bar-bg w-full h-4 rounded-full overflow-hidden">
                        <div id="progressBar" class="progress-bar-fill h-full" style="width: 0%;"></div>
                    </div>
                    <p id="progressText" class="text-center text-sm mt-2 text-gray-600">0% Complete</p>
                </div>
            </div>

            <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-lg p-4 md:p-6 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <button id="prevMonth" class="nav-button font-bold py-2 px-4 rounded-lg shadow-sm hover:shadow-md">&lt; Prev</button>
                    <h2 id="monthYear" class="text-2xl font-bold text-center"></h2>
                    <button id="nextMonth" class="nav-button font-bold py-2 px-4 rounded-lg shadow-sm hover:shadow-md">Next &gt;</button>
                </div>
                <div class="grid calendar-grid gap-1 text-center font-semibold text-[#6A5A82] mb-2">
                    <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                </div>
                <div id="calendar" class="grid calendar-grid gap-1"></div>
            </div>
        </main>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>Preparing for twice the kicks and double the love ðŸ’•!</p>
        </footer>
    </div>

    <script>
        // Firebase config - replace with your values
        const firebaseConfig = {
            databaseURL: "https://pregnancy-tracker-ee2e9-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        document.addEventListener('DOMContentLoaded', function() {
            const startDate = new Date('2025-05-29T00:00:00');
            const dueDate = new Date('2026-03-05T00:00:00');
            const totalDays = Math.round((dueDate - startDate) / (1000 * 60 * 60 * 24)) + 1;

            let currentDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);
            let checkedDays = {};

            // Load data from Firebase
            async function loadData() {
                try {
                    const snapshot = await database.ref('pregnancyTracker').once('value');
                    checkedDays = snapshot.val() || {};
                } catch (error) {
                    checkedDays = JSON.parse(localStorage.getItem('pregnancyTrackerCheckedDays')) || {};
                }
            }

            // Save data to Firebase
            async function saveData() {
                try {
                    await database.ref('pregnancyTracker').set(checkedDays);
                } catch (error) {
                    localStorage.setItem('pregnancyTrackerCheckedDays', JSON.stringify(checkedDays));
                }
            }

            const calendar = document.getElementById('calendar');
            const monthYearEl = document.getElementById('monthYear');
            const prevMonthBtn = document.getElementById('prevMonth');
            const nextMonthBtn = document.getElementById('nextMonth');

            const currentWeekEl = document.getElementById('currentWeek');
            const currentTrimesterEl = document.getElementById('currentTrimester');
            const daysAlongEl = document.getElementById('daysAlong');
            const progressBarEl = document.getElementById('progressBar');
            const progressTextEl = document.getElementById('progressText');

            function renderCalendar() {
                calendar.innerHTML = '';
                const month = currentDate.getMonth();
                const year = currentDate.getFullYear();

                monthYearEl.textContent = `${currentDate.toLocaleString('default', { month: 'long' })} ${year}`;

                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                for (let i = 0; i < firstDayOfMonth; i++) {
                    calendar.appendChild(document.createElement('div'));
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    const dayDate = new Date(year, month, i);
                    if (dayDate < startDate || dayDate > dueDate) continue;

                    const dayEl = document.createElement('div');
                    dayEl.className = 'day p-2 h-16 md:h-20 flex flex-col justify-start items-center border border-gray-200 rounded-lg';
                    
                    const dayNumber = document.createElement('span');
                    dayNumber.textContent = i;
                    dayEl.appendChild(dayNumber);

                    const dateString = dayDate.toISOString().split('T')[0];

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.className = 'day-checkbox';
                    checkbox.dataset.date = dateString;
                    checkbox.checked = !!checkedDays[dateString];
                    dayEl.appendChild(checkbox);

                    if (checkedDays[dateString]) {
                        dayEl.classList.add('checked');
                    }

                    const today = new Date();
                    if (dayDate.toDateString() === today.toDateString()) {
                        dayEl.classList.add('today');
                    }
                    
                    const daysSinceStart = Math.round((dayDate - startDate) / (1000 * 60 * 60 * 24));

                    if ((daysSinceStart + 1) % 7 === 0) {
                        const weekNumber = (daysSinceStart + 1) / 7;
                        const weekNumberText = document.createElement('p');
                        weekNumberText.textContent = `${weekNumber} Weeks!`;
                        weekNumberText.className = 'milestone-text';
                        dayEl.appendChild(weekNumberText);
                    }
                    
                    if (dayDate.toDateString() === dueDate.toDateString()) {
                        dayEl.classList.add('due-date');
                        const dueDateText = document.createElement('p');
                        dueDateText.textContent = 'Due Date!';
                        dueDateText.className = 'text-xs mt-1 font-bold';
                        dayEl.appendChild(dueDateText);
                    }

                    calendar.appendChild(dayEl);
                }
            }

            function updateProgress() {
                const checkedCount = Object.keys(checkedDays).length;
                const daysSinceStart = Math.floor((new Date() - startDate) / (1000 * 60 * 60 * 24)) + 1;
                
                const currentWeek = Math.ceil(daysSinceStart / 7);
                currentWeekEl.textContent = currentWeek > 40 ? 40 : currentWeek;

                let trimester = 1;
                if (currentWeek > 27) trimester = 3;
                else if (currentWeek > 13) trimester = 2;
                currentTrimesterEl.textContent = trimester;

                daysAlongEl.textContent = `${checkedCount} / ${totalDays}`;

                const progressPercentage = (checkedCount / totalDays) * 100;
                progressBarEl.style.width = `${progressPercentage}%`;
                progressTextEl.textContent = `${Math.round(progressPercentage)}% Complete`;
            }

            calendar.addEventListener('click', function(e) {
                if (e.target.classList.contains('day-checkbox')) {
                    const date = e.target.dataset.date;
                    if (e.target.checked) {
                        checkedDays[date] = true;
                        e.target.parentElement.classList.add('checked');
                    } else {
                        delete checkedDays[date];
                        e.target.parentElement.classList.remove('checked');
                    }
                    saveData();
                    updateProgress();
                }
            });

            prevMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });

            nextMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            // Initialize
            loadData().then(() => {
                currentDate = new Date();
                currentDate.setDate(1);
                renderCalendar();
                updateProgress();
            });
        });
    </script>
</body>
</html>